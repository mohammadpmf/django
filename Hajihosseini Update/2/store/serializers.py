from decimal import Decimal
from rest_framework import serializers

from .models import Category, Product


TAX_RATE = Decimal(1.10)


class CategorySerializer(serializers.Serializer):
    title = serializers.CharField(max_length=255)
    description = serializers.CharField(max_length=500)


class ProductSerializer(serializers.Serializer):
    id = serializers.IntegerField()
    name = serializers.CharField(max_length=255)
    inventory = serializers.IntegerField()
    remained = serializers.IntegerField(source='inventory')
    price = serializers.DecimalField(max_digits=6, decimal_places=2, source='unit_price')
    price_after_tax = serializers.SerializerMethodField() # ุงุณู ูุชุบุฑ ฺฉุงููพูุชุฏ ููุฏ ฺฉู ุจู ุฏูุฎูุงู ุฎูุฏููู
    # ูุณุช. ุงูุง ุจุฑุง ูุญุงุณุจู ุงุด ุจู ุฏูุจุงู ุชุงุจุน ูู ูุงู ุจุง ฺฉุงููพูุชุฏ ููุฏ ูุง ูฺฏุฑุฏู ฺฉู ุงููุด ฺฏุช ุขูุฏุฑุงุณฺฉูุฑ
    # ุจุงุดู. ฺฉู ูพุงู ููุดุชู. ุงฺฏู ูุฎูุงู ุงุณูุด ุงูู ุจุงุดูุ ูุชููู ุฏุงุฎู ุณุฑุงูุงุฒุฑูุชุฏ ููุฏ ู ุงุชุฑุจูุช ุจู ุงุณู
    # method_name ุจูุด ุจุฏู ู ูุฑ ุงุณู ฺฉู ุฎูุฏููู ุฏูุณุช ุฏุงุฑู ุจู ุชุงุจุน ุจุฏู. ุงูุง ูู ุฏฺฏู ูุฐุงุดุชู ู ููุท
    # ุชูุถุญุด ุฑู ูููุฌุง ููุดุชู ฺฉู ุงฺฏู ูุงุฒู ุดุฏ ุงู ฺฉุงุฑ ุฑู ุจฺฉูู. ููุท ุญูุงุณู ุจุงุดู ฺฉู ุงุณู ูุชุฏ ุฑู ุจุงุฏ 
    # ุฏุงุฎู ฺฉูุชุดู ุจุฐุงุฑู. ุนู ุงุณุชุฑูฺฏ ุงุณูุด ุฑู ุจุงุฏ ุจุฏู.

    # ForeignKey ุจุงุฒ ูู ุฏุงุณุชุงู ุฏุงุฑู.
    # category = serializers.PrimaryKeyRelatedField() # ุงู ุทูุฑ ฺฉู ุงุฑูุฑ ูุฏู. ูฺฏู ุจุงุฏ ุง ฺฉูุฆุฑ ุณุช
    # ุจุฑุงุด ุชุนุฑู ฺฉู ุง ุฑุฏ ุขูู ุฑู ุชุฑู ุจุฐุงุฑ
    # ุฑูุด ฑ
    # ฺฉู ุจู ุฏุฑุฏ ููุฎูุฑู. ููุท ุข ุฏ ุดู ูุฏู
    # category = serializers.PrimaryKeyRelatedField(read_only=True)
    # ุฑูุด ฒ
    # ฺฉูุฆุฑ ุณุช ุชุนุฑู ูฺฉูู ุจุฑุงุด. ฺฉู ุงู ูู ูููู ุขุด ู ูููู ฺฉุงุณู ุงุณุช. ููุท ุข ุฏ ุดู ูุฏู
    # category = serializers.PrimaryKeyRelatedField(queryset=Category.objects.all())
    # ุฑูุด ณ
    # ุงฺฏู ุจุฎูุงู ุงุณูุด ุฑู ุจููุณูุ ุจุงุฏ ุชู ฺฉูุงุณ ฺฉุชฺฏูุฑ ุชุงุจุน ุงุณ ุช ุขุฑุด ุฑู ููุดุชู ุจุงุดู. ุชู ุงู ุญุงูุช
    # ูุดู ุจู ุฌุง ูพุฑุงูุฑ ฺฉ ุฑูุชุฏ ููุฏ ุงุฒ ุงุณุชุฑูฺฏ ุฑูุชุฏ ููุฏ ุงุณุชูุงุฏู ฺฉุฑุฏ ฺฉู ุงู ฺฉูุงุณุ ุฎูุฏุด
    # ุฑุฏ ุขูู ูุณุช ู ูุงุฒู ูุณุช ุฏุงุฎูุด ุจููุณู ุฑุฏ ุขูู ูุณุงู ุจุง ุชุฑู ู ุงุณู ููู ุฑู ูู ูุงุฑู
    # ุงูุง ูุดฺฉูุด ุงูู ฑฐฐฐ ุชุง ฺฉูุฆุฑ ูุฒูู ู ุฎู ฺฉูุฏ ูุณุช. ุณุฑุงูุงุฒุฑ ููุท ุฑุงุจุท ูุง ูุณุช. ุจุฑุง ุงู
    # ฺฉู ฺฉูุฏ ูุจุงุดูุ ูุง ุจุงุฏ ุชู ููููู ฺฉุฏ ุฑู ฺฉู ููุดุชู ุงุตูุงุญ ฺฉูู ู ุจุฑู ุงููุฌุง ุณูฺฉุช ุฑูุชุฏ
    # ุฑู ุงุณุชูุงุฏู ฺฉูู ฺฉู ูููุน ุฒุฏู ฺฉูุฆุฑ ุงููุ ุฎูุฏ ุงุทูุงุนุงุช ฺฉุชฺฏูุฑ ูุง ุฑู ูู ุจฺฏุฑู.
    # ููุท ุญูุงุณู ุจุงุดู ฺฉู ูู ุจุฑุง ูุณุช ูู ุงุตูุงุญุด ฺฉูู ูู ุจุฑุง ุฏุชู ูู ฺฉู ุจุฑุง ุฏุชู ูู ุฏุงุฎู
    # ุชุงุจุน ฺฏุช ุขุจุฌฺฉุช ุงูุฑ ดฐด ูู ูุชููู ฺฉูุฆุฑ ุจูุชุฑ ุจุฒูู. ูุงู ููุฒ ุฑู ุจุจูู ูุชูุฌู ูุดู. 
    # category = serializers.StringRelatedField()
    # ุฑูุด ด
    # ุงุณุชูุงุฏู ุงุฒ ูุงูพุฑููฺฉุฏ ุฑูุชุฏ ููุฏ ูุณุช ฺฉู ุดุงุฏ ุจู ูุธุฑู ุฎู ูพุฑฺฉุงุฑุจุฑุฏ ูุงุฏ ุงูุงู ู ุงุณุชูุงุฏู
    # ุงุฒ ุณุฑุงุงูุงุฒุฑูุง ุชู ุฏุฑ ุชู ุฑู ุชุฑุฌุญ ุจุฏู. ุงูุง ูฺฉุฑ ฺฉูู ุชู ุงู ูพ ุข ูุง ูุงูุน ู ฺฉุงุฑุจุฑุฏ
    # ฺุฒ ุจู ุฏุฑุฏ ุจุฎูุฑ ุจุงุดู. ุจู ูุฑ ุญุงู ุฏุงุฑู ูููุณู. ุฏุฑ ูุงูุน ููฺฉ ุงูู ฺุฒ ฺฉู ุจูุด ูุงุฑู ฺฉ
    # ุฒุฏู ุดุฏู ุฑู ุจู ูุง ูุฏู. ุงูุง ูุง ุชู ุญุงูุช ุนุงุฏ ููุท ุนุฏุฏ ูุงุฑู ฺฉ ุฑู ุฏุงุฑู. ูพุณ ุจุงุฏ ููฺฉุด ุฑู
    # ุฎูุฏููู ุงุฒ ุฑู ุนุฏุฏู ุฏุฑุณุช ฺฉูู. ุจุฑุง ุงู ฺฉุงุฑ ุจุงุฏ ฺฉ ุชุงุจุน ุจุฑุงุด ุจููุณู. ูุซูุง ุชู ูุงู ููุฒ.ูพุง
    # ฺฉ ุชุงุจุน ุจู ุงุณู ฺฉุชฺฏูุฑ ุฏุชู ูููุณู ฺฉู ุฌุฒุงุช ฺฉ ฺฉุชฺฏูุฑ ุฑู ุชุญูู ุจุฏู ู ุจุนุฏ
    # ุงูุฌุง ุจูุด ูุตูุด ูฺฉูู ูุซู ฺฉุฏ ุฒุฑ
    # category = serializers.HyperlinkedRelatedField(
    #     view_name='category_detail',
    #     queryset=Category.objects.all()
    #     )
    # ฺฉู ุงู ฒ ุชุง ูุฑูุฏ ุงุฌุจุงุฑ ูุณุช. ุญุงูุง ููุช ุตูุญู ุฑู ููุฏ ูฺฉูู ุจู ูุง ุงุฑูุฑ ูุฏู ู ูฺฏู ฺฉู
    # ุจุงุฏ ุฑฺฉูุฆุณุช ุฑู ุจุฑุงุด ุจูุฑุณุชู ู ุจุฑุง ุงู ฺฉู ฺฉุงุฑ ฺฉููุ ุฑูุชู ุชู ูุชุฏูุง ูุฑุจูุท ุจู ูพุฑูุฏุงฺฉุช ูููุน
    # ุณุงุฎุช ุณุฑุงุงูุงุฒุฑุ ุฑฺฉูุฆุณุช ุฑู ูู ุจูุด ุฏุงุฏู. ู ฺฉู ุณุฎุช ุจูุฏ ู ุฎู ุญุงู ูฺฉุฑุฏู. ุจุง ุงู ุญุงู
    # ููุดุชู ฺฉู ุฏุงุดุชู ุจุงุดูุด.
    # โญโญโญ๐๐๐๐๐๐ ุฑูุด ต ๐๐๐๐๐๐โญโญโญ
    # ุงุณุชูุงุฏู ุงุฒ ุณุฑุงูุงุฒุฑูุง ุชู ุฏุฑ ุชู ูุณุช ฺฉู ูู ุฎู ูุดูฺฏ ู ุนุงู ูุณุช ู ูู ฺฉุงุฑุจุฑุฏ ู ฺุฒ
    # ฺฉู ุชู ุฏูุง ุงู ูพ ุข ูุง ุจููุงุช ุงุณุชูุงุฏู ูุดู. ููุท ุฏูุช ฺฉูู ฺฉู ุชุนุฏุงุฏ ฺฉูุฆุฑ ูุง ูุซู ูููู
    # ุงุณุชุฑูฺฏ ุฑูุชุฏ ููุฏ ูุณุช ู ูุง ุจุงุฏ ุงูู ูุฑ ุชู ููุฒ.ูพุง ฺฉูุฆุฑ ููู ุฑู ุจููู ฺฉูู ุชุง ุงู ูู
    # ๐ ุณุฑุน ุจุงุดู. ุงูุง ูุญูู ููุงุดุด ุนุงูู ู ุฎูุฏู ุงู ุฑู ุชุฑุฌุญ ูุฏู ูุญูู ููุดุชูุด ูู ุฎู ุขุณููู ๐
    category = CategorySerializer()

    def get_price_after_tax(self, product: Product):
        return round(product.unit_price*TAX_RATE, 2)


class DiscountSerializer(serializers.Serializer):
    discount = serializers.FloatField()
    description = serializers.CharField(max_length=255)