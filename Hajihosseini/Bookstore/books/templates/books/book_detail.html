{% extends "_base.html" %}

{% load static %}

{% load crispy_forms_tags %}

{% block title %}
Ø¬Ø²ÛŒÛŒØ§Øª {{ book.title }}
{% endblock title %}

{% block links %}
{% endblock links %}


{% block content %}
<div class="d-flex justify-content-center">
    <div class="row w-sm-75 w-100">
        <div class="col-xs-12 col-md-3 d-flex justify-content-center">
            <div>
                {% if book.cover %}
                <img src="{{ book.cover.url }}"
                class="img-fluid rounded-start" alt="Ø¹Ú©Ø³ Ø¬Ù„Ø¯ Ú©ØªØ§Ø¨">
                {% else %}
                <img src="{% static 'icons/book.png' %}"
                class="img-fluid rounded-start" alt="Ø¹Ú©Ø³ Ø¬Ù„Ø¯ Ú©ØªØ§Ø¨">
                {% endif %}
            </div>
        </div>
        <div class="col-xs-12 col-md-6 text-center text-md-end mt-md-1 mt-4">
            <h1> {{ book.title }} </h1>
            <h5 class="small my-1"><span class="text-muted">Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡: </span>{{ book.author }}</h5>
            {% if book.translator %}
                <h5 class="small my-1"><span class="text-muted">Ù…ØªØ±Ø¬Ù…: </span>{{ book.translator }}</h5>
            {% endif %}
            {% if book.publisher %}
                <h5 class="small my-1"><span class="text-muted">Ø§Ù†ØªØ´Ø§Ø±Ø§Øª: </span>{{ book.publisher }}</h5>
            {% endif %}
            {% if book.year_published %}
                <h5 class="small my-1"><span class="text-muted">Ø³Ø§Ù„ Ø§Ù†ØªØ´Ø§Ø±: </span>{{ book.year_published }}</h5>
            {% endif %}
            {% if book.number_of_pages %}
                <h5 class="small my-1"><span class="text-muted">ØªØ¹Ø¯Ø§Ø¯ ØµÙØ­Ø§Øª: </span>{{ book.number_of_pages }}</h5>
            {% endif %}
            {% if user == book.user %}
                <div>
                    <a href="{% url 'book_update' book.pk %}" class='btn btn-outline-primary px-3'>ÙˆÛŒØ±Ø§ÛŒØ´ Ú©ØªØ§Ø¨</a>
                    <a href="{% url 'book_delete' book.pk %}" class='btn btn-outline-danger px-3'>Ø­Ø°Ù Ú©ØªØ§Ø¨</a>
                </div>
            {% endif %}
        </div>
        <div class="col-xs-12 col-md-3 d-flex flex-column">
            <h3 class="align-self-center pt-2 text-muted align-self-md-end">
                {{ book.price }} $
            </h3>
        </div>
    </div>
</div>

<div class="d-flex justify-content-center">
    <div class="my-3 w-sm-75 w-100" style='text-align: justify'>
        {{ book.description }}
    </div>
</div>
<div class="d-flex justify-content-center">
    <div class="card shadow my-3 p-5 w-sm-75 w-100">
        <h2 class="mb-5">Ù†Ø¸Ø±Ø§Øª:</h2>
        {% if comments %}
            {% for comment in comments %}
                {% if comment.is_approved %}
                    <div class="border-bottom mb-3">
                        <h5 class="mb-3">
                            {{ comment.user }}
                            {% if comment.is_recommended %}
                                Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…ÛŒ Ø´ÙˆØ¯ ğŸ‘
                            {% else %}
                                Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù†Ù…ÛŒ Ø´ÙˆØ¯ 
                            {% endif %}
                        </h5>
                        <p>{{ comment.text|linebreaks }}</p>
                    </div>
                {% endif %}
            {% endfor %}
        {% else %}
            <p>Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú©ØªØ§Ø¨ Ù‡Ù†ÙˆØ² Ù†Ø¸Ø±ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª. Ø§ÙˆÙ„ÛŒÙ† Ù†ÙØ± Ø¨Ø§Ø´ÛŒØ¯</p>
        {% endif %}
    </div>
</div>

<div class="d-flex justify-content-center">
    <div class="card shadow my-3 p-5 w-sm-75 w-100">
        {% if user.is_authenticated %}
        <h3 id="insert_a_comment">Ù†Ø¸Ø± Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:</h3>
        <form method="POST">
            {% csrf_token %}
            {{ comment_form|crispy }}
            <input type="submit" class="btn btn-primary" value="Ø§Ø±Ø³Ø§Ù„">
        </form>
        {% else %}
            <h3>Ø¬Ù‡Øª Ú¯Ø°Ø§Ø´ØªÙ† Ù†Ø¸Ø±ØŒ Ù„Ø·ÙØ§ Ø§Ø¨ØªØ¯Ø§ <a class="text-decoration-none" href="{% url 'login' %}?next={{book.get_absolute_url}}#insert_a_comment">ÙˆØ§Ø±Ø¯</a> Ø´ÙˆØ¯.</h3>
        {% endif %}
    </div>
</div>
<div>
</div>
{% if message %}
<script>alert("{{ message }}");</script>
{% elif error %}
<script>alert("{{ error }}");</script>
{% endif %}
{% endblock content %}
